<!DOCTYPE html><html lang="zh-CN" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>记一次ilibilib参数逆向 | x2d1</title><meta name="google-site-verification" content="u163KTfURAZuf9TQWoQRP6mIW_2y4ffpkYttxC3RYmw"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" as="font" crossorigin="anonymous" href="/font/Bender.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/font/BenderLight.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/font/JetBrainsMono-Regular.woff2"><link rel="stylesheet" href="/css/arknights.css"><style>@font-face {
  font-family: Bender;
  src: local('Bender'), url("/font/Bender.ttf"), url("/font/Bender.otf");
}
@font-face {
  font-family: BenderLight;
  src: local('BenderLight'), url("/font/BenderLight.ttf");
}
@font-face {
  font-family: 'JetBrains Mono';
  src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
</style><script>var config = {"root":"/","code_fold":15,"search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy"}}</script><link type="text/css" rel="stylesheet" href="/lib/encrypt/hbe.style.css"><script src="//unpkg.com/mermaid@10.5.0/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/css/all.min.css"><script>if (window.localStorage.getItem('theme-mode') === 'light')
 document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark')
 document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.woff2") format('woff2');
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><style>:root {
 --dark-background: url('/img/night.png');
 --light-background: url('/img/day.png');
 --theme-encrypt-confirm: 'confirm'
}</style><script defer src="/js/arknights.js"></script><script defer src="/js/search.js"></script><script defer type="module">import mermaid from '//unpkg.com/mermaid@10.5.0/dist/mermaid.esm.mjs';
window.mermaid = mermaid;
code.paintMermaid();
</script><script async src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script async src="/lib/encrypt/hbe.js"></script><script async src="/js/pjax.js"></script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js','data-pjax','.busuanzi'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><meta name="generator" content="Hexo 7.3.0"></head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><nav><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup" tabindex="0"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/friends/"><span class="navItemTitle">Friends</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>记一次ilibilib参数逆向</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2025-04-30T07:28:44.825Z" id="date"> 2025-04-30</time></div></span><br><span>Last Update: <div class="control"><time datetime="2025-04-30T07:58:32.792Z" id="updated"> 2025-04-30</time></div></span><br><span>Word Count: <div class="control">2.2k</div></span><br><span>Read Time: <div class="control">12 min</div></span></div></div><hr><div id="post-content"><p>版本：8.42.0</p>
<h2 id="eKI1k"><a href="#eKI1k" class="headerlink" title="eKI1k"></a>抓包</h2>

<p class='item-img' data-src='/2025/04/09/bangbang_protect_1/'><img src="/2025/04/09/bangbang_protect_1/"></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp">POST /x/passport-login/oauth2/login HTTP/<span class="hljs-number">2</span><br>host: passport.bilibili.com<br>accept: *<span class="hljs-comment">/*</span><br><span class="hljs-comment">accept-encoding: gzip, deflate, br</span><br><span class="hljs-comment">app-key: android64</span><br><span class="hljs-comment">bili-http-engine: ignet</span><br><span class="hljs-comment">buvid: XUE61EAECE03D3FB36487B78EBC1F5F96E3E3</span><br><span class="hljs-comment">content-length: 28352</span><br><span class="hljs-comment">content-type: application/x-www-form-urlencoded; charset=utf-8</span><br><span class="hljs-comment">env: prod</span><br><span class="hljs-comment">fp_local: a0ff491bd997295faf0bcaa8a986c4c9202504222203543d9822a4c0573514c2</span><br><span class="hljs-comment">fp_remote: a0ff491bd997295faf0bcaa8a986c4c9202409121254363df3cb17624b67a9ad</span><br><span class="hljs-comment">guestid: 24548810039087</span><br><span class="hljs-comment">session_id: cbfe884e</span><br><span class="hljs-comment">user-agent: Mozilla/5.0 BiliDroid/8.42.0 (bbcallen@gmail.com) os/android model/Pixel mobi_app/android build/8420400 channel/html5_share_source_qqchat innerVer/8420410 osVer/10 network/2</span><br><span class="hljs-comment">x-bili-locale-bin: Cg4KAnpoEgRIYW5zGgJDThIOCgJ6aBIESGFucxoCQ04iDUFzaWEvU2hhbmdoYWkqBiswODowMA</span><br><span class="hljs-comment">x-bili-metadata-ip-region: CN</span><br><span class="hljs-comment">x-bili-net-bin: DVVVFT8gAQ</span><br><span class="hljs-comment">x-bili-ticket: eyJhbGciOiJIUzI1NiIsImtpZCI6InMwMyIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NDU1OTY2MzEsImlhdCI6MTc0NTU2NzUzMSwiYnV2aWQiOiJYVUU2MUVBRUNFMDNEM0ZCMzY0ODdCNzhFQkMxRjVGOTZFM0UzIn0.ZfiA3pbBa4d9hv8se7H_4h1vRFKzSy78FoPLAjhXnnE</span><br><span class="hljs-comment">x-bili-trace-id: 628066b1e949a3c75834272712680b9e:5834272712680b9e:0:0</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">appkey=783bbb7264451d82&amp;bili_local_id=a0ff491bd997295faf0bcaa8a986c4c9202504222203543d9822a4c0573514c2&amp;build=8420400&amp;buvid=XUE61EAECE03D3FB36487B78EBC1F5F96E3E3&amp;c_locale=zh-Hans_CN&amp;channel=html5_share_source_qqchat&amp;device=phone&amp;device_id=a0ff491bd997295faf0bcaa8a986c4c9202409121254363df3cb17624b67a9ad&amp;device_meta=A5C0CE4CB6ACAD0ACE202870A1150F7AE2A6E8BC40B61103C6C4BBEE30DFABB7CB315510C0533F5EFA8B3557C121AB4B08D69ED4C308BC02D7DFD671B3CACC51CDF262EF9E0CB0CC683EBC37A526DD785184DA5E0484ED1F78821D7B0785CADE84D7764C01B6278AA17E42855B31499B87C87D1C2AA9E1D4618FF089A9CD7D35697548D9D71FE47224A66A7D93F581D55B6E6433ABE2816DD137D6A5E1D7BD2A4A82C7ED91AF7B04A3899C37E3941BDFC3705AA2849A770DF346D6D52CD6C809F58AEA86961BD5C29FF1D647CD98774318570B127DB643F0266050F11019C397555AD756015C47A09B30891E094ADF7889F3329CD5E351F46AD158172153B09F52492B542F9F889814857D2071A40700A5D45315FA98CA6542632B4E728D37CB907101A08D734A5B56303821122EB1B720CF4888CF0C45CC2E10F67DDC8310FA8C62418620FB30BE03C3F7297D9FCC06E15BD1F962CE2716A7B5EC8112932099776ABD2D65F4C3A57EB6B2796ADC48CC3ABA1738186DB08DE69484777863A380C4517D6B88ED595015CA361DCCC8CED31A9172C002AE4BC7CE4BFA00BF8724327DB7BF0B9C2ED374CD2D182E049A2D10C4788A04E696B2452F96F3BF73E1B8C8B29BE6095F8D6405D956847EBB043A8C08A90D1A99308A008C8B0CC7883D4269C50A0D9C008B81A3CF273C27AEC64B34A52D1197A00289AB0888EE7C17059821F2926C99300EDB8038C0EBB70E56ECC93FBE31DA325098A9B438ACD963ACE33999F3ECF464D3E1E63AFA4D2FA0C42D62F94B5FC3914F3E1929FC685FC3D0685F400E6CB6774C1234F4401AD7CA9995B35975C989C0DEC9EAEA8921937CF1256DD1B1B41A4AE113FD5D5C0160AA1B60C2DE33C2ACDC6A7D68D366EA5DF0122CA25FF364C9B8D74DF805E72B12FAF2265AB36DEBA8F1F948FFC68DDEC6FD573F9692DE81AA888E7771B27249EC699FD7F0C79CD73F7673D6458B2CC2617A5FBE9F725A8E3E5095D46A0D9AF0096EFEBAEF3162BB3E4016659A6C7D1503F56A5E286D5F76B226CB573F47100D9CC112E03EE4C2744FE816C8A68D9819078F9568FFBC773D76318B991EFA812CF6BB2C1580FFC61772F0E861FE4556591710B4CFD180D0379B6413217AAE45B066C7FCAEEA364D4CEDA14031FCE1186AE2B46DA2BCB363DC998AD7E9304E9EFB59E31CBC301644AD84988993982CD585699B1E2FCB1992982D59DED012871A352B16B293C646D615C2D003010CF5E7BD5445C854D286A6AC46EEFEDBA110A9AA67CD5AAC4EA739B9ED1E60D6456E29F62B02F902964214276AB10AD16818745BE06D4FE14859CFBDBC5FFFFAE49860EA8B99A4BD3D92EFD67F1389645310A626176466490EC15DDFF384820F01BF7D1FD75A1300A5F37993A99D09C4785971DD31D9F68A186DB4983098E006A0146FA6155B2F224EBFFFDFE972FBC4732D14EAA824B40D30EFB174CAB1DC231E1CDA47310B346F9298B1AB0A615188F72A1F76D45C9CE53735092448F01432AAF6CBEA451A75F7D727FCF7BC8469475A079180DE2B2AF36F1F0BF12E497048FEF8FBA71A4310D706A95899097E1416CCB3B49A9D7A1A05A0436850EEA869E3CA1DAAFE03C1BF134A089DE7748416BB24105BD1E66D85C565F3740AABC15941F4BB52683CE9AFDD257358306E4D69DF5E55B353B1E22D44963575EB53DE7423C4F8E6BE264888316990C68FBC115414E3EA8EADE154AC8D8FF0225B2B9235DEA033AF887CDD8F9C968891EF3ADF2EC7F803539207AEFDCA371D9F777F7992E21D1F9CFD2DFB99E4F74955DF1B576017098A538B4151BC2DADDFD2D950333861D26DBB6EFD3B5404C57EE0AF8FA2B17244CB85A99643E0002F4B9C3107CFD7281E57410B466FF168F5BE69976ADEFD5B042D48B4584ECCA7AB560993CE65903753E9CCC6E6D227C86EFEFD1C2555DA08262D7564B1F1BBE8812F7CB3332F07498428A9D4115F8743B2E5DC5BA101595D6D3B8FD00C8CD728CD6EEE6CD621298221359E124996A6F6103AD086F37853C8B6B10BD6B6AB4DF77495D43038947825531488D1AB960A4D68577ED567EE360E710905521BA8902ECDF196D1752D483600BA6948354FE1A8E6976EBC7870ACD6BCDF6A368B0CAFE3EC39B66EC74BCA6F5B28254D78B98395F7ABF95AF5FFD8394D5AC246CFE1094FD7AA87CF52A450B32DFBD77E601C575F24B08DF6CB60A5D92EE409DB313CBEBF4BCBBAAB8C385160E48075C3883B241F058B1825F15A4EB56080FCF4EA3985FF9EE15B9C35DC483882273CDFF7D80F003EDC752EA6973C81D9471D36812D9A0126220F232C29DE98D8AADDBE853A23878DA1F0C3F4A018B59A0E0E9DAD36F6839881A5625C86888478CAE262A331FCC57D8635C17770E6CF851E7AFCABFB8F33C07205019EB9E6788B6785B71627ACBB3FD88CB148C134E269392EBE284F1CCA905407302861A8482013738986D82E5086D5315704B7B772A6F8883AB5868F6BE8C979EA7E4CEAAD05537AD2F63FA5157325050312B6DB36213C656F0D13471D99FC193B4D42D2A08F211072BC1D3CBA446910F038E1434F6CF3091F58E19FA9876FB537608CBB3C7F5E64087B06F8C3696B2DE37F1E4731C93B1C96D294FBE2CE1B8AAAF6380792DD0FEE3FA763E76306D0CE3D7A8F116E8FC7AA549A25CC57AA9E1F450CDAD9B1A9189D3B4D2F88E39AFD73690CD79AE9D011901D70558F305C16C57C1F7AAAB108F6CF57AB3C189D3ECE9A13C0F8891DFC4C059451DDF25A52A2F52927F422BDBACB4968B06B252271D0859140F0CC6759577937CF756985AA69BA277B9E52E553D408821D2996EC92AFE70D03A4B13F282F9BEBBFE0A0CA25E2E4864AEA45420F71A90457F83DB6BD7071703784E88F62F3F61562F416A4B3D5D986A053BD363A7BAAFF66123D6152DB1BB0E9777A30FE9E900C2C59AD8A1941728E81CC46583220FE3CD83683C7DD6E126925A53F7C7153DFE237745E87CD0ECC2BBF6AE9FDD5ACE3D572D00BFB7F664DE13480B8277DB74B73BDF1163333786BEBA4063AD9C072E0D370E0C76FDE89C2AC9BA7927823F081AA08F16B735161762549D54939BD3C2BF38095643201A79BD97C0C4BD44B931A5FFED2BF595AA5485F70D3D6A195057D97D5069BB48B04265441923B63BDBC9100046FE6758D94D4A6CAA8D3F78FF1A00487BA017C8F27A931C70D4B750BAD4443CB69EAD44DC6C90D8DBAB146594C308ADCBD0ADD1A070EA1DD44DF2D6291EBB34C5CF3657970D9A3B1685976E84AAA8D0BDDE0DBB4DF4C17BA47D74C06F92324984058ED3410C2547A176CD06641783680DF2639F8383AF0FCD741A52514CA782E9B5EE70FF0D1C0552ECC925EE9409E64D341EEA1A96F7A7EC99B48CEEEFA921DD87DCDA224C823505819BFF7CBDFC2A4E04488C18E03ADA90F69E8B4DD36A05E55E9EF41EAB836BA41B4CB2D7864EDEBD044DA95ADA3BCBF77FDC71CA88B4A4BF5BC532E001028ACD83237A6B2A8C28728AF1D16C1E560E45EA961A72B418823946F6C69750337EAB91A567E8832BD7F8E83A32AB48DD7B95DAD403AE3715CD2D3ABECE33A4597D2301206D87989EFA7652C4F77F57C45D5D052A57E59DCFAF0535380D56433093A0F3A248B5BD59F01793A9FC72D5DD1DFB56FAA325B34F75B60FB00002D97BC688A492609A238BD7EFCE40975302B5B20CB29AA26B18F37FF8C5F7D1C9EC0EECA3AB73B2476B9D95179F6B0A86521FD36EFEA2F8074E4E253035BBA74E931A1922EB6390A75F5ACA3D4B375B4F2CD55787B93C21467EF441DE30E20932323D5F6953BBAF4FE562C84098FAE946A23E054DB8B0058100D7A52DB5BB18F7F381861B7ADF86E87B6C2431EC315E40492DA8E510F0C04E671B59C89E493FE87E723BC8A953BFFFD502B99ED7B2A465F2B670C3BF4392B5B71004B0C6B5A4D69FB7348AD30128A36BE5A59A9D09831404B3C667302271E8BD11B0090E7AFCB26AE3B8E8441611543B93602953CFA0793129A9E836E80BBAB7A1AB164299A5B73F0344DC9B0A7CB5D1CAEBB80D24C54DCB52265FA0C33C97EF969541DC2CD02191C5472093EF4BF1F436BA9A80EBEA2D6EA9B880C470FA5BEF5823D2F6683FF6CD6DE8BBCB1DA83A3C30A4A02DF40681F2BD7C2A73E0DE5350F6BE866761C041CC8825348F9F2C1BA2F6B79419C684096CB64C34C235534B0ACE6E735F824F6E5BB2C784CF31BB6C10BECF11BA81B76849D355E793DBA1A4E8179D41A216FFE9B36EF57F37889B2EA93244CE9438C9D5B55AE826EA380DBB2D309368C324BF4F8B3ED2888C73E3BF744439EA93F7A0156961627298AEBE6BC8B461B8413C964403B609A57B3D9C347E568EDAC6101F7BD4705D8D412E12F20A6DEF472D2B4C755CF74710F094E867BB94CD6B25B5961FEA31262145778902AF70A6ABAEEC2A611190C2996F5199FAD0954307A0B1CC852A325951B27142012BAEEEDED13C4D0A35FA036CF073479EB1DA8FE8A085D6571242F91AF38ADA712DB76049B510238CEAFFE0DCCC52DE55A6C51FB046BA36F9BB99951E72629CD6038DD0E265A328AF0EDC23DF149AD9D58C6758063D13F83EF370573005FE0F333E66F1A8EBA1E70E724DC2C3A2810631CB3C1F7D285B77C594B83A4829733F0853EE4E77BBCABA35798ACD73D6DBAC1C56D5AE9D1C6CFDB57F76676E183CD1A4BA70C2301C729EB27156B73E27177F2B34EE7867ACDF8CC77959692EDFBC7762F44D17E67C24C7C11676C6252CF4E501908E6043D0856D32C51521A3AA2D0DA8970FA7C5F43F4FD6600A9FD764D65C91916D19D4F9200D769A473C45CF1B8B06CA2CFDBB7FB249B1166FDA3EF7A00D302735EE72EFE95DB43A630970889F0E4074072A351C79591DB41F24CF1CC2DED3483AAED513653E856D16A490F5F9EC9A4E99E9DFF2CB27CA6608B1570D3F28825DA040170D18A7F9D3BFECD9365C361302B5C5AD76F6C5A863689345CAF79F763B9E476CE0CDB61B364C05F8BA8B4A315BDA10861725F4C2492A7B6D7E0394E8807D6AF8D47DA96C5B6188F924AF1871FA35B3563F9EFD63F560AFDEEA4434854E472857277033F3E793C4CF0992E7D46669E1FED81B81ED1D3890A91B8A02EA0396065113498590082436F142D56171A19ED323391B5DE28BD33B2A420D4822FC2A8AB2DADCD636ED485A6DEF197C8781C481CE5CD55B327F3091EA7AB74F8FB0AC7294BF9A500CB74409EBDD69376A38BC6FA3275AE721B6CD16F994236F9DC027D9E670663C856D6AB6C6FFE43E32782338620E14D75C59A07343A014FC4BEC45F5D3772B04D7CDDCF8B873018827413373A267BC5BDCDBA5DCA7D83BBB4E266DE025EFCEE2A22A6840FA6CDAA1178007C4250AD8F80EAABF0933E30E63867342675A2B8E4D74C080877FD52777DD00748117FA9E51F2AF52C2FB262E54E8CE7EC2DED1FD948264FC5A110DFAA7E65E3697412BB327B44766D6182DA27CD97768C5AE5DA149BFA1105B136EAB1955023874F4AC66AB9140E85F8D01BE7438332A44FFFF1BEA448B2A58849CCC1755A77919300317670A2F7DEA66D15AE8335C03D7E7CA84471C18EEC117203BBE93D32A7603EF8AE7AB899DFC06498C21D7BF17B9262EF1F59A9554E6237110EC836802EDC89D1156C420B416C399FF56AD4408974051FC9A69EAFD49B8DFB8D537BC400E5D2CD8D6B6C443E4BF50DBCD4A240C7A1ADB6D368C4DC1F6F5529EF2B2FDAED1CA7F255FF0197D17DCFC747FE43E93388EDCFF2EA76FB87BCFC980F3E16B49F1CDE872BC97AC8CF133883F30777095A350983F2A3225813FD83CB290F4FA29316E2EF83D71C9EE3776304EA123EE35035BBD42059649E7C381BDC6C9D246A92B1A71409A4F1837404182D1FA3B680BB3C4778EA3EED4D71768BEE3825A553F390DB1CE65D0BAF83785C7F55B7A379F97558AE2915A745C18A6311E909BEE5C5247ED9C78DF9CEEE3166862D33149DC698CD8953C8BE7AE727B30231960AF879AF7FAB4AA43DF08676046130B1B2F41FD826A2011861959BAAF978AB079372B9EF3559C1FDF6BBA0EDA67BDE01AB9F7BFD4FE6F8BD81F63ED18A3A2D27BBD23901328951A7F629C4BEC1FF964135D5AB79C00809A2897D5F1A87A0326FF939DF58BD8F66B4BA4CFA7FCD978FDECD6DEBE0472C57CF7A0DB8AF92D730A477546B8DDC1C25AF5C4F047E41DF8C929C3874AD4127C248230DC9A5B5DCE17AAEF0C7D81D523439783B1A7F6B2D4C3788A118CB009CAB45AEA99BE9684C6A3911C7E1B14BB03EB525114CA53F890718F8FFAF61791461E8E32DAEA50ADAC41A3232563CF272C8ED3843AB82870E61CDC9FEA69CDACC4A017ECB0C3E9891D5E111DAE8146E74305BB4166986A9145F618887B58C09BBA500DEB510C81CB4C1D533B3653278A63EBD5D82E3FB047C2C7E3181682695D445047AFFCA2309FF01917FEB47236E86F60814E53BC3224781C4D0381C2C8DA36B365F1F5D674FF5ABB2F1E96697CC102EB5416171121E14F94948AC2EB4396D37C85E3849E69A7CFFCCA3071FC63276701776A41484B1E6EE0017E567AF665D87D1F19CB6E2F0CE74C106E5B17C7AEE5D11F75991D28D322D7503034564A94AE84226965BC8B5416EA569A3314D4BAD501090B088F80A74D0FD1D43427BB45D2305C9CCB6050E97B9B6B26EE3E93541E426CCC1EFAC12BEDC799EB3161AE643D66F7351522B22C52B63C69C7EDAF5BC1412C97EF4678BFD90F221C48494FBEF1DA11A941B4CFE060C698383BF3C5726D78200720D6274594BC784FCEE9A2203E41F4FA45343FE4A252312B4FE20F96107E281AE1AF35BF99001DF97BE1D75FBD2F0EF6D709865D71E9B86546167128A8E006989D3FD688E3E5F248DBBA82BA3B7DD8AD6AB7B20C0856E6A6B6377D497937516D1BB8F85BB92C23E35CE7E5BCDA55CCB130F913F325BBFCFD3487E9BF82837CC8A3E7285B188CDB197E2EA6EEC241C7651426FC162B0CEDCE99C109D8B9420F3734DB742DB9B0388763807D813A1EBA700253BC8F1797E072F374396ACBDE754C5CE86E5875FAB33F1479C6702A7B22E1056C22EC99E3435F51A5CD1519F93AA7618EE7FE3B93A3ED86E3580644251AC884784AD79CF70CBC328F7E8324FDC916670FB125468BB934E5E6D2A0237B308B31421F804EC1F631B4DB0DF14FB652E9452EEBEDB5543B381A9113B8E1A0449E6E23ECD31E856CBFA879452DBFBBC5A4C79597158A3EDDC1828AE0C32516F3BD9C5AEA8F8A607FB72A5DDB63CABB043E87881319EC1C6ACDFA333836EF44340BD389F5CF87BFB896A9433D812F227101FD62C0EA916B5D4D0C5DDF7AF5F8C4F6660BA64DA29A3BD021E380BA29E637BDCB1D2BA788FF62C48A944B515BDE2E60DC982927AD2671BAA6B558116487A774B341C2D082DF51ABC60383A48D8AF997F3532CD045E0830F714577F94B9AC8F7331E0DA637827F09A0C091F1ED5E762693409DEE31F73AC0221D2FEBBC794DD9DEDF5BC89B50FEE461A8AB89043B8039A2C6FFBAEA8DF658D823A54FF892A9169F7F5483E424E0808185F480616A48A63120EFF3C78EF73A30C9F570BDAE19B45ADFD07C34821F8BE026C520F79A1D50D049A6DFB27756AF9AF094ED67AA149A33D7CFB2088222A29EEF46AB11704D2D815CE656E599C475B868B8F5582D3B2AC73E2DB9BBA02548CC03ED2A0E01EC6C035853A79621E55FAEA3408C2D9AFBCA6B968A49BE5B788E7FDA96286B11EA1E6156D202DD3ACECD1D87794DA449639692B2DCDA1C2025E2C62FF8D5097572E490AA71B9BEE3802C71DBFC2F93446769862E7766F17E3A069D8FB9660C35E095A9BE4FEFD6B2C7D4407F82E0591BCC0AF96D417C4EC0385F086B2D3CFA330A92AF4901D402CF6143D0AB0599CDC81340809A2BAD9085197A079545B3C0630929AECF5BB008029B4714C8FF5B3855823D210D9E370AC0D4D29E89008BDA0CB8377EF03B24B60C0B50764CAB4FD7B12C3B95BB5842333253B0ACA8339DDA342AC149265B64D273A3C20CC5BF2045C21DE9F183F9A1A061DDD65E08CC4A3A7E6606FB2C2B413348EB51BE7C9E7B5FEF2A3C9E2104DB3F9F2ACC5A6D40B52DA23C6900F2E67FCA33631ABEA03FFC8AED27EB30E56DB55E121B00A363691D8627512F6CB7B82237539C3E997E5035BEC5C72932D6CA4D32D2724616FBC88CB30E7915D75DD41F888523FFD07616B8EE0BC38339D8A4B0BB969E85A09369165FC23A2EACE1A3BB2D50706F9043CD4B42E721FEE9EA4649CF4372957754589F1EA3CAB0617E9EFC82952F0343DA7BD99BAE62B0E57507168D395EBA1CB710D40793B395C220BE4799DDA4F52B0B70A24045F1F36595B27203456D42A219185008289EC9D2AECC847B1D99C9BD18669FC4730B1EE5A1BAB447D9AB71BAA3ADA472594A15CE6F1F6B2BCEB2C339BE7D608ECFC3D40581CDAD51B6AD8E862CF8BBC6ECFD911F1165D76FD611C333AA84195E40539C6FD54C7B18461FDF3BB93BB05A71FD750D24F1D971EFD676FB9D0E6926A2E9FF272E2308B0A91B1285A73F4108F7859B6293749D2C5AFB00AC168322ED74AA3B88BC0345E693C918B10CD6D7772BCF4A8D57D6F5A9CBFE6CC445C4D5681F1ED18FDC62DC2164B35E2FBBDB346E0CB88CC47AE26053C674B25F2F310DB3DB17DF35AD1CB184B62607359C7AD13135F129720EC729C3F51E10C4AF944D0DA7CC28409D429B01786ADF0FDD175509EBD2CF8A32AA2AA9844A1502017CCA84309D750A1D1D3B628E55484CE7E8348E183EDCBE8BBA9A6BB9D048EDD315045F29F7D915B3DFC8AA3D05A5B0018F212AC683B5DD5A59F64D32123F449A43A9E1DA88B300C2F21F395172673A5E61604A9B55B88CFDF869F9B82652EA0FF1287B027CB741AED49468AC9BDAD69E342A3F7D8B307D0F800E76DA058815E5A9C990D733BCA8BECFF9B2E554CD137619FA9097D6C31FCECFB426A345C8E2950A34F5090979E14B444B883762FEFBE06401895FB902DAA29B605BF9B435F7C456ECC1B68D338BAF256751BD2AEC2FD2C96793AC4E763D6FC4E399F5DE4890644DA332459CD6B340305BD7A2C52B9CDE794612B5A4D0CBE75844C029A0D47B83505BADC221EE9AC15905611A550240C9846BFF086972FE1950C9A60B831359CEF6FD3F947B7AAA279EA5D72722119FA62EEBB590D7560C88689A4091BE0065CAC26BA6C1953230C551BD49758A86F85CC70370235DBF30548D2BD83433C4924E4EDD24EFE0D18F5B78415017E4EB6433663E26A043266F993E6A3D8821B62CEB16DB789E9F3BBD9A4C227A8515B193A4C261940A0C03BFFE02CE4711074BA0D0319E7ED7A43B576B0F85436C2ACCE4819984C529AA5ECD7BDD4AC3308412FAE800B9AE94B1F2FDFF62B0382B4D92069765BD3214F5D6C4A5518CC1E5609B276D9AF94065CB087773573952CC7FEB9F981AC91ED541EE7A5CF1E5ADF1EF18C7E2722990B5979F195B2106B360FC0D6AF0FD7024FE4E29FBC13A36CABCA2CA584246D57FF4B3946731BE568C36EFA8DBAC0C2686D14C90F19721E111A26D3DA26483F733F9598F5050F62E1FCB1096B88368C90BFCFFA7879BDF45FC20FC25C04C19A24675D5A6A4C4504B1A16D5D7ED1B7178AC13D59516D2562CEEB37CEA81389DA0CC6C07093E83FCF2F6E2BB9729998D3B1A635C35C6270EE1B9C74CDA023E8A0657ABE352A488B99454BFA856D204B6FECD8D51F5902861A05D374CE9312FA8C4D2E780CACB24F9EE787268810CCB6E1393E3D20DF16D134D126652F135BB7321713CC0B50A2419B4BDABECEC95D02BFABF06A37794A017B0E42BB2113CB234EEF28E7AAF01D67F9E896B32DB4B91EF6C87619DCC10B1BD7FAF33A799821E263A81E01913BC1A4BEB42A888E701640CF3E9C309C8C473FA94499E76F99F53EB9C434547A7AD823615B145C8FA62ABC5900B78B4E7968EF90D0DDBEC0731B169A4A6DC7ED48183B96914BB1C8A0EA4022F4E079DA069FE735212DA416846BEAC94839BD70EBB2ABD12AA4FA8A196A5F5FFC7FCCC827A90ADE467AEED3827DA1CDED10B8D550CF0C5F4299C7B79E0C7255329EDE8FFBB1F1664FC46D91041046D927494D0C2DD406F996CC400340B02316590358B5F6E9D40423A069C882B0C1035F5F0052D271750DA843E5A2CE9699A052EB536C94FACDA8864BC3555EE04C57AC3F1ABAE86E6A3C5E4620591F36AFDEDF1CF4F644D70844E91E4D49423B174FF05CEAF5339ECCD48F35F77C0B25C26EB987F9B3B105C831FAB5421D78E4B0B79C8E87AAA8746DDA54D428C4EE56C8329D3C5314A902548A434D600472ECA81AC99DB97A1B32DDA265F7AAAF1C2F78FE0131EAAD1EA6881D7541A36FC840B3215EA3F3249BC59F345B375495F62202DB4111F07784ACC21D95DAC099B6EEB358E5E2D59F9366FB0AA4BC9A982DFC4857731D01A4E8CAC9B9BBD9054C7990C56500E8F904ACB2608B7EE9003D62914D85503B7E7255D9CF5A65D022CBC2DD449FC10319DB4E03DFFCE3090D4634EC62FD2E550419EB2D97F31D18129066F256444539FACB5278BC1832B9A36B93C9A6E53A30F22514640DA4B403D2FA86569A09A5E274A9975DBFF033BA9054FAD6168D3BFE6430C70EC79B4408E5B35CD73D2493CA8383910370CC572BF23D39A95BAA13A957DED71599A6A5679A3ED68DEE7115A7E93B1FB9065ABAAA152E29E886023C0F497EA577DDC58049944D3AF9C0630E625C2A56AC362DE39A8302392FF254F366B696345F6C4A999DB2CDF80409EDAE7E85E98AA86C2E29BB1F362C7E00275438D76E6D5489912019AFF026F53F323AFC96B5C8A14DEFA5011E22A3140442C71A9AE8FAE4DEF1A4B367C0026D1E23E6A3C8B15CA461541AB62E45ED4E521CBD25B520D6F4B697A561ECEB8C7ADEE12705B13D47936E206735E3678AEAB3A83C45D93E9A2AD7596102F63113B2390CBA3AB9233B12FCE3DBE69FCBFB2CD247F932CD731DF1331E560B8881EE7E2252F2E317150665FD45CE3F854A39264BDBC3EF53F2C0F5A915DF2B4451F5861EAD88AC258CBD771725E83329E276316EC3F5349988D21CDE28B47AB6DD28A7FFC6F66D57987C4921A0330162F8F0406ACBE8BBD23F021058D773D1D248EA9E164A478CCC1A7631EB9DDC8ED37BD94DB95DA70A6198EBA2384A0F6A8F8ED5A1978EDC1007D3758DAB31395706951491FA179556AE6B45126BE01560B68D38F528701FDFAE5611F05A35AA398DDE52858088EF01473F34E5B2B74D2942ADD460FC5E2E715820224A48867003E2AC81E72F00BD2C1DA6DA8CC82A5D8287B54AADAD1EBD57E315279A612865DFA2D52C47494598BFE95C70346A212A4A92C105BE9B60219B56C1C1FE817005949B78A4559E0CE4DC065F75C3AF0DA877E5FFCC89EAEB016E88BDFDBEC256A8C3E44121AE8AEA4206B9DB4C3AD052F74F2FABC2612D9C9CFD822953C7636C1D7FA4D9D9725A684E41EF8307EBEF02342A3AC974B126C48EE7BF06262A25744A20A252FA655DC61E66D01BF2395AE29F7BE13934F2D57AC41D610B32FD33CF93132EAA7BEBED92904F6FBBEC6984134DE6629B25EDD1F712C3666BAB601D02FAEF37A00E4006E762E9701F3CDAC4EDA213996C1B0386F9B025A5EEBA57A67E81D63E0D653320B835E70C6B72139607786C2CB53D56F118DBDF847CD88DE1CE344EC20AA6E9F8BAE5DD569827DB0810127A1EA184051D3F9DC317F9DF02704610DC4AD91A6B95E2F1B3F17DCDFCFAAECA20DE6EE1FB9501AE94E62A55032FE46126EEF57FC604F9D0C7C9CCCB1F83C0CFA9257481F1A290AF13A71ADA6FFE40442749E73006D09F388855DED578E6676B211CC1FD8CE2BECE8F04FD7FF9B3555353DC695F3D52E6EC163F8594160C64D7179B9C8F1FA0FBE36E060DF496EC06F24580EFB97D1F36D5E77481C1F7090A9BBE621E6D3E4113AE0C034316303EED8A2BD7D82679C8F32952BE2B10140B180FC6BB58B706C98FD15F4FD375817F44CFAA71816681A15A4EE8F5305146C0E1628F8AC9F7CF2FC453542700D7FE53ECF47A7568684AB7E7CC491CF2066281F485966AD19B992590341DF2A50D6AB3275931FDCF4AE00EFBFF474E6B65CB1C12F4753AF88BBA91BF042BFF6E998ACD485EE514D7BE7513643DF0238738D58E48669DA74D1BC15B34434C65FA6650764CB1CD5F113E2617B6FEE55F233D0891635AD5DD5CAC35700A6A298DFD21735535F777A62D5B223A346D33CB5DF5D2F546D2FB360A8B061C56CB9DBB358847B0230496DE9FCC6BAF0F5A13ACFBB7BEA0F5760EE3DF2175471E5B5A5B677C36A383A73D322D734BF78376510BA6CCD04CB303104B10D1A6C8C18D3A915CF0263FBD60648CDA7632858D8C52DA46DA49F534C1E8E2C7C30E94C07DD5F88F8603DCE5AD30E06E7597484F12AC44671F39B4D5CDA7BC216791BF58C1F559A27FAA58FFC51782ADD09ABF30257A276735CAA00C155034E7A65183615B75A505675873389D141659BA073CE942589DFAF5CA17190660381359A6946A02C1F1FD7728E742C5DCFC0C697666C4CE68B3533DBA5195F0B464FDFC098361CF31362803AD0F5E4EA7B4143DF98A961369B10326A51EEF35EA5C4EAC72AE59C977F042FC42E57B261DEFEB16D169E996E596EAA57E798C581C9A535AA208BB7B453E6EC0C775E7509A39BFE74FBDD1FF5CD02A4028600243251F2E04327E620EA80DC4F55D779BD759F7FDAFA71E4351062A94228238D78440262A43C4F8B825D380386849DF566AA35271E5165EA61B469C12A3D2EF6AF07927195A1418ACC2E6B2175FCAC1658BC0A835D3CB5101941E121B76A754C8817140FAB2A96BADFFA50494F882B46C6FE40FB4ECEEC1B5E8BDA46862EFB15BCFFE8E2A94EB43B58913D25822AADAA189621C1C0BEFA236CE7B4B265C4410EBE04F12CBBC9117641B20286FBEB4DC2CB36C20FD6529B6AC1521641DBDBD8F489832F1359A199298671B968AB86DABF1ED90EF48F7A9C6BF0124105AC7D5E0CCE9B1BBFCBAD5B5A9631D17211424DFC53FE5B9D746BFAC1D877F4FDB41D28E0F6382D8B26BEBAFF17F3A8C9CA41299FE2E0C39FAFAEFAECC5A8AE899A2D334C8E824A2856C859ACE87C4633A3F98FC735479626C9873BBC3CE8854CA179E3A6F45AC13535CCDEB7224FA8FC0C337B3212E494F37D3E4B191778367911E0FEFE1CC99DDD2914CA380C0E2EDA4812FC420F4361056D891E4F4F76E1C606C393016B95E50FA4A49C7344F5CDEA0C62B36E49DE0346B95A630F33828660CD823D29B9894DEDD898DBCD385CBC66B1E858C574AA5DFC5C1A23F535C567BED04B3F523FE598CEC3445337AB15382D570299AC66651C8D35BE4A84FBEFF8946F2AC2B5BFDF81B84FFB235F4BDC50B2BA9432125ACA3AEA34B9632DF3DDC18A48C2E985DD1C6367D843093D3028ADD0274F461E3ED362A2C5083A3F0344A4E97F892A6AE44CDF2D1F3D481DC567C5863D34E6EADF24886B1B6A0BDC88AA04460DF529F630E670243F4EABF981087667D410756D1F50CD9C95C72FE2EAE909C290018AEA4966E5FC27E11865835710E071D84AFE7A23DDC19B5C00D41D4F256951BDB8D0F02A687E8D4FF1C70692C777A013522785DB78EA251CEF3775FBF754989FB0B4BADF2D62349A757F4C7B01C2FCF6DCA91B8DD87D52207C8F5521F007337F6C5AF8F67FE05C5C6702E232720BBF0722481F27E19CEF3618C6F98D1D3242F6DC0B3DD87E51BBC287285527E27CA4B99B139F093ED8ADC9B426490DFD684E09198B6A9C3594A0A3192D8126D66248A17EF7A36F02AE536FF00983FD530D48147E0EB6F4FB0AA47F595194017BE7E025887653A7A3F035C80BA9834B3B1FB30FE0CF482B998A8C91A8EB99F7C2CD8A0D5494AB0C27472C400B4E16D0CA3C9D1C87D5317A50E01B273A3AB7B652F1A20115EAD3EDF3156A5C4992C4E1F911B559F302904F2C08EC05B2C9402FA3BD56117C1FC39713E7D2A6BE2D03AF7F95B8E53DE8781EDFA02CD00B96271565400FE999165972B79D9A331F8C51717E6E2F2ADA64C1206CA73C52536FB836F1A63186B80063F72BE479868CE7100B6B4E243316E5A9A7403CC1EACC696AAA92E1833FC98139984AC95FF6B9A24E391785F0036B9DA01575C37282E8BC13AE0144AF55A7BF522B14D1C7CCD3F8049E8B6158B6FD9444FF1B9798600392255AF7754D8B886648BDFBC8485299B205222E1D75C6D4968FC9D388B1DD22753A4DD9C9AD33BC0D9A356DFBF2D35DAA6D27BD27D829682413CE3B6E1E0BD383AA930919C4E0C038DE7A68A45741D935135037C6E117C660369220E009C0FA0781866232E649B6F56351C5B52702F2FFDB14AA0475175A664CE1D3223A18D7CC00A3E3C24C1E20280260DF4C9386337FA7508016AB780D390347539E10D4DFB6EA711C083F919D764C8E63C7D9E6EFFACA07E415102DD3DD2BF6BB4C58315584E35EC37EF02EDED8B12165D477021149438BED59612AE636397B717A08C59765CBC62EEA85257417C0E3DB38B2D9B06FF28D44370F5506DDEE240C12DC03CCDB7841097BD51A7FACA83051AD021E71A403D83D4E40DD2D13CFEC960E258507774E399DC4C551C430C79ECA9E13D69A44C362483F3A7818C3EA66EA64CDD3785C5D520CB3D8C6AD18DE70A2341AF39917932AC592C3A81B7B3B5A6D60E266198F5AF1B72782CE7395EAE905C4F6537624F864523EA4624EFEF417C6D7D839A7D9EBE2CC8041B85C86137B6C0BE9E15C5DF73BAD85B7B9E3F094E4CE365956234D77171A021CB85556F7FD770213A47FE9CCE7CA2D3539C4AE905F384DA75AEAB8C0B9D57E29003C20BD8ED19294B325964093958D3143A93E03F49724FC0A95BFDD4F9F78710A43B64145EE1AA57FEB021D92B5C35F13C6B0555AE7500185697B5E07CC81481FB20409251C45A393F17FA75697EDFA76979689F2BD6C8C3BD3752236214AE01049727F35296D9A7E405AEADEE7968C24BBDC5A87F0FCF625B87E7684D11F80E62FEAC84727FCCD98624E8B12D2E0216357B23B369E43A162C414D3A01C7A8992355CA6952DE41510539DA2CB0FB11B2DEBDE7519B76F2A830F4EBF22AF7158750652EAFC6F361E880A55B3CF1B519A11AF8020D617115A0C369AC51CBD325A82A0045E0592EC72FAE4B92C7E04A8382C085F59670586643D757D1D974A971515BFF18FECF1ACAA31FC35FB5A2283ECE8EC49D7B350D93E1A2032A8A159E7E29B949AF5211596B8CD153B7D0DF60EB14EC037ADCC89B3B61BD66CD21D65C7FDA211A0396B0A95111D94BB0F3989453C45016146AE5E288C6323EA1EE80860C503D86ABF6031470C7E489FDFAFADEE5DF6B5D9667A9B03EFFB428052B3CBDAEC5DCCF03F51DC79CA440127A4A440D80EC7EF5B4ABD1FEB42B9EDE65B352E43CB9995315D0989FAA29D12777C9968CF7805C39C6B67B0CE3C7FEEF441AE46788636002B03062FD76C9793B3B43D5F607B0FCFC7C9B0CC116470E3E866FFFDEA78CCA3ABD20F26E740E248BB4C19EA29B42A588686357F8E9DFD88E1C4EFCF9235B1E93F679123742DFABBA2D17F2CEF8F93980DFEA30D5C4ACB5692F8286CB6CBF0D86505ED129D45E881BBDE023E1BC5E7C8BB0C73D6475419A0E3A0F12EF299758FEEC7A9C8F60425986FB3E8169079F9986E0D48D9F3DE04304836CA8E460FD938A1FC3DEE5370A6DA5AAE4E667EED96616C84CD9E87FCBB460B16E3F29D1EC752EC5BAC2058D8D1698E5D80672686CAD4BB53B3683F4B5ACEA1CBD1DB1B593C48C80CD0C9994739B5FFCFB350C209E4F419C3A9CBCE444D45A77DF2E67F5EC8CCE73CA371DF1791BFFEFEDB655E7E23487AE82CEDAA181CC00C1ADB03FE0932700DF76411B5DB9287102F88837727E7F6670BE433B0A0712E2470777A46F464508E3D4C3DBB2AC60770ABB9F30C7B42CF32F4DE3B39168EA418A10984943D0D81B9D6C7637C8DBD91CD9E070E414F148318E03F04A45D69304743754B29C6827B538EB97B8D321F7C80E1F5B8B21E7FB4A6E43133534569AFBE291858F547714059068C85E202CE850016CC61F61D8B02F7502EA57EC047C5C63CCB120E7CC006EB8905D838BFC85745DF5060E3D387FB07ABC226B5D1C4006ABD0B9203B8CEA488E0C63C7991683A0D7D067F345DF5532E6BACF41DEF254CEC7AE361502BE9699AE895B1D2AF47AD3B1E16B0EA14B87A4A3EFFD6123232C6A7AF9E8CC881742DA94DA8D248875329B77F73F9A79EFB520A1100389A63D4CB9217A9FAD2801AE823C095F8A73650CEE3EBD508B2C4159E55BE3AAB6C82CDE67A9FA691D16A939AF88F1F7BF9F1F6793F339964C551E68C6EAC2CCEB30BD694C465B13E7F86B25987D28B471A9FFA5674AA802DA87D8E34E197961C5F4E1B3AAF9AECBC4CF9721DA5A1F514AEA66A432E63207B9C454FD5F02C1E8FDF79682D4E4EFC3E3713A1F1DACC9D98A93DEC82E4D4A8D84065E94FEF7F5C8F12C012BCBC93BDC1D95DF30033F33602A4318C3E971F64E97534729A127EBC93049B2844E1CA2178CD7580673F8D3B79F22F9AAE300053D61404097672F568CF4723D00586AF90F24C33ED6CFE6D03B79ACB94DF02CB4678EF0F5C11B7115B0CA9307649E16C51C6FF85912807B789F3F3514B2A294112B1A214ADF8C1DD87CAA06E03D7BB99544978BFAC8CD6D067EB491967B22BFB5DACB0B02D39DE17A4C59CA2664FA360660DB570CA0974559830A57FCA9006367BBFD27C6763235139A29868CD36C65BE76562FB68B30ED7EAE2D46BB5EF9E70FCE4F7899E55080BF4E4809911F8D315E03D6D511C892E92943E977F5C5760B88C7360B289D484F8DB34EE499F48A957BF2B56E1C536EAD1FE3CDB2CBFD458BC92940C544CB146A12F4C94119BBCCFD07F3DE47D63330D331AA1686C522A4A923CD6B141B20FA2E9C034AEFA6565FDB93A549F98A359E1B9211A50E5BE14A8D1F95C7AD9A1DE495D354188B32257FC5B4F4EB0DA2605288C9A2A09FBF058C8292E083D8583516B4B82B9A967587EC9D2DF83CE52CCF3BBA493F79F6146E68B1EBF142FE50636132EE9B00083512125A00A4AF3387C230FE67E5EC3C01DD194468FFE0FFDAB43138C74D49A327209C7FFC2EA767E49BEFDB9EFDD4B272554DC834722811F1A605ACABDC44B90E4974C171709E22EAEF6CB8A6926714229939AB7FADBBEAB27391D343D457111259AECCE365443C5F12A134D10172FA92E3B9F55062BA1016A1C58478598B74D427A1DF4DF9589371AD12458D68024B64257E1EC0B99D50E4B6C6BB9E214F93296ABB10EE5C548FAF4AC914AB120ED540DDADAB0EA7FFF348CF824C7F0D80E1DF8E197F9E644C34748AFA1F4CAC72772C76A827F7159C14BECCABB0E451D0F4548C853F70D137BE57FBCA32C5691EA712F3A6D22D0E32989F2CB398D5E0B10E85B936E8BEC5B58DF9EEF87D3486B3C4042D4909FC1BB1F26CE8E44AF01AA2E25902EEF1A845F50B4E59E85F6E7E83E394CE6DABECB15BAF0EBC90773B9BC367486945305634638575350E6015972C26B5F0E243D744B5DB04A294EA7A5EEB813D1D6764888ABEA96CA6EF7BF9D98D87B39EBA9884345CA92689E46B7C425D7F788863D520F8B48FFEBCDCD61EBA8FD868413D489EEE4DECB616710E5ECDD71C019901888773B1CDE539CC34DF84125F983FA4390C3CF3A86DA7BCD618A02B20F862394CEF44E2CEE557D302F49E0017EBD53F233A6DB1E6E3021E77C4856B7CF1E9F436CAD80BD6FB890F0002BD81C21E4AE1A69E4BFEF36D130FBDD5AC69F7D49276B54EF8BF5E6DA19518309994F556FD54F83DD0E0B8F877B768C684EAB056415647F4B9B99D1C970FED9B54B01431861412F8D200684518419B77AFEBF456DF3187457DCE111008DDB74B43DD0156673999D83091C11F90700C6391BC4E12746EC66BB721B708D04AC5F841747711553912923D22BC13F4E03AB6813673F6CACEEFEA4A0A893C2F000B0553F706B0886C61327BDA3C7197751DE0410D0B1F11FF65DD3F807637C0E0CF9F69C539B50EEAE3B4CFB2F5895DEFC4E8EFEA0180E00C525F36BD2A246652A619C963DF032B357DAF8550F5CEFD6A063A57898847173BED35F82F9AF0084400456B1BA8B744C674E409D811387EC41E20C7E003EA56DBEE7019E080A4F66BEAF5ECDA441C80FC1585D8E012F7715BDF0D219DEBB6DB9FBFC37DB557F728B000B6EDBA3384102B36F221A7D9AF04F4442D8E793FC80D4CE858736A5A2E872C68501D50AFA527720F9530EE23710D18A53DB0FE6A7F8C9CA82002894B9FCBE5574BC79509BBF66AFBE4AC4A60D1ECB7AAF968BD1A94B9E32E4FBD2B82409CD5FB4A6B8610C4E12449B0FF3B15D5AF665608440CE77D03C65586300BD9871EC9197EF42C97B7C94751FDF2D76A5472C58122E0D78198DBA5F6242E62C589DE4FD6A5EB96B1B73F35CCDA756600699ED437E89AC9015FB2A4CF64F62547B7CAA1422EA593DED13B776F60A2E2F0FB2F6A543568DEC2C7E2FC51D71F1F26C22A4B0A1DB6900616FB3D66E68AF7A63EF4D8F93F119B747141348D5E24D99026EE998C9FAEFB9619A631F8385CADC30AB85FA51653B8ACA391536B43B3E9BC2BD8644FD2B7BA2EB60066BF357D435D3E958974671FC97999BF2366E4C27FD2140862F32CDE771AEF0599D2AA04073B2FE2A5656DCF80911A09FBFBF848DC3B0F820E0055A2B9475ADBC2FF228CED013CF5DD971C5A3BECF925F2BC1B0F45C2FA46D1E198C83D8C4D48B71E9B1C21F15E08706827A8A92FC28861EBB8A1F42F89121A5B2AC6E26FBEB20433C9BF17DA1EE0B905BF8546D9F9D4662EBD3647AAD1B14FC353C6DFE9A91FA1D301FE0E9E2D7EBCCB848E3DFB027D69DA66550A2A6C9B03F414EB989B690210128F523B872FCD1F1EC4891AF64D07FF0A41C9AE344BAAD7515B815F3920E2BDF3D6716F243CE4C1F4FA4C05BF1AE69C078F811D29CA2ED8E2C806761174884F3900E9D77DC9D282E42864F8D962CE00F20CDB2C916215CB52D51D5981A6B24A32ADFB2B95C76C10ED51786860FB6E4B1D927459AAA52BAA567470FCEB0FF0A7B51EAF67&amp;device_name=GooglePixel&amp;device_platform=Android10GooglePixel&amp;device_tourist_id=24548810039087&amp;disable_rcmd=0&amp;dt=WbsDs9%2F8PG29XfRqHyF6CjeRTDMkLOy31QTjU9OySZ0hKP8amsufLr%2FyKME7FGCYxG0ct%2BMVCIBJ%0AA1arQVdiMdoVqKN3A2Xz3tJEiqUFxWoyVFEca9OEEjK05xzQVenW6zP4LRwDCQSFvQDPRt%2FUbnpt%0AZqb9PTrGtlirLBCOf20%3D%0A&amp;extend=&amp;from_pv=&amp;from_url=&amp;local_id=XUE61EAECE03D3FB36487B78EBC1F5F96E3E3&amp;login_session_id=9a8bbc6217ae96dec11c9fad20a9732b&amp;mobi_app=android&amp;password=E0d7HG3pQommdU9rclangxHzyMbQusWPV7b3vqIkMHHV0sT0hFCsTxH%2BVy5jfAg2mFaGiIRDyvob%0Ad8%2Bhpw05oTlgr1JuzcaMmQuV8tCoBB2x1kK9R8%2BHuDE26sheSWjKEubsEbShpffQcBWlBEkpjOQh%0An8Hdf3yRcjgsCSU5UUM%3D%0A&amp;platform=android&amp;s_locale=zh-Hans_CN&amp;spm_id=main.homepage.bottombar.myinfo&amp;statistics=%7B%22appId%22%3A1%2C%22platform%22%3A3%2C%22version%22%3A%228.42.0%22%2C%22abtest%22%3A%22%22%7D&amp;ts=1745591810&amp;username=15982339904&amp;sign=17a949bd74918fade743ec7c5527b304</span><br></code></pre></td></tr></table></figure>

<h2 id="r0v2r"><a href="#r0v2r" class="headerlink" title="r0v2r"></a>JAVA层逆向</h2>
搜索/x/passport-login/oauth2/login定位到关键接口

<p class='item-img' data-src='/2025/04/09/bangbang_protect_1/'><img src="/2025/04/09/bangbang_protect_1/"></p>
<p class='item-img' data-src='/2025/04/09/bangbang_protect_1/'><img src="/2025/04/09/bangbang_protect_1/"></p>
<p>大部分的参数都在这里了，唯独没有看到sign, 那sign应该是后续添加进去的。回到前面的地方，这里可以看到大部分请求都会经过拦截器AuthInterceptor</p>
<p class='item-img' data-src='/2025/04/09/bangbang_protect_1/'><img src="/2025/04/09/bangbang_protect_1/"></p>
<p>进入AuthInterceptor类，其中signedQuery方法十分可疑，返回了一个SignedQuery对象，跟进去看看这个类。</p>
<p class='item-img' data-src='/2025/04/09/bangbang_protect_1/'><img src="/2025/04/09/bangbang_protect_1/"></p>
<p>用frida hook验证发现这正是我们想要的sign，交叉引用却找不到在哪里调用，那就用frida查看堆栈调用。</p>
<p class='item-img' data-src='/2025/04/09/bangbang_protect_1/'><img src="/2025/04/09/bangbang_protect_1/"></p>
<p class='item-img' data-src='/2025/04/09/bangbang_protect_1/'><img src="/2025/04/09/bangbang_protect_1/"></p>
<p>根据调用堆栈我们发现，SignedQuery的构造方法是在Native层调用的，也就是说sign是在Libbili.s方法中生成的。LibBili.s位于动态库libbili.so中。</p>
<p class='item-img' data-src='/2025/04/09/bangbang_protect_1/'><img src="/2025/04/09/bangbang_protect_1/"></p>
<h2 id="h56gB"><a href="#h56gB" class="headerlink" title="h56gB"></a>native逆向</h2>
.init_array中的函数用于异或还原被加密的字符串，直接用解密后的数据覆盖掉就好了。在JNI_OnLoad找到动态注册的jni函数

<p class='item-img' data-src='/2025/04/09/bangbang_protect_1/'><img src="/2025/04/09/bangbang_protect_1/"></p>
<p>s函数最后返回了一个SignedQuery对象，SignedQuery构造方法中的两个参数就是在这里传入的。</p>
<p class='item-img' data-src='/2025/04/09/bangbang_protect_1/'><img src="/2025/04/09/bangbang_protect_1/"></p>
<p>sub_18FF0就是我们要找的生成sign的函数，使用frida hook的结果如下，第一个参数是sign的缓冲区，第二个是要签名的数据data，第三个是数据的长度，最后一个参数p是根据appkey来生成的16个字节的数据p。</p>
<p class='item-img' data-src='/2025/04/09/bangbang_protect_1/'><img src="/2025/04/09/bangbang_protect_1/"></p>
<h3 id="VvDIC"><a href="#VvDIC" class="headerlink" title="VvDIC"></a>unidbg主动调用生成sign</h3>
前面已经得到了加密算法的参数，借助unidbg我们可以主动调用sub_18FF0生成sign。

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.bilbil.sign;<br><br><span class="hljs-keyword">import</span> com.github.unidbg.AndroidEmulator;<br><span class="hljs-keyword">import</span> com.github.unidbg.Module;<br><span class="hljs-keyword">import</span> com.github.unidbg.linux.android.AndroidEmulatorBuilder;<br><span class="hljs-keyword">import</span> com.github.unidbg.linux.android.AndroidResolver;<br><span class="hljs-keyword">import</span> com.github.unidbg.linux.android.dvm.*;<br><span class="hljs-keyword">import</span> com.github.unidbg.linux.android.dvm.jni.ProxyClassFactory;<br><span class="hljs-keyword">import</span> com.github.unidbg.linux.android.dvm.jni.ProxyDvmObject;<br><span class="hljs-keyword">import</span> com.github.unidbg.memory.Memory;<br><span class="hljs-keyword">import</span> com.github.unidbg.memory.MemoryBlock;<br><span class="hljs-keyword">import</span> com.github.unidbg.pointer.UnidbgPointer;<br><br><br><span class="hljs-keyword">import</span> java.io.File;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.nio.charset.Charset;<br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">x2d1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractJni</span> &#123;<br>    <span class="hljs-comment">//unidbg模拟器</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AndroidEmulator emulator;<br>    <span class="hljs-comment">//Dalvik虚拟机</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> VM vm;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> DalvikModule dm;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Module <span class="hljs-keyword">module</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">x2d1</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">//创建64android模拟器实例</span><br>        emulator = AndroidEmulatorBuilder.for64Bit()<br>                .setProcessName(<span class="hljs-string">&quot;tv.danmaku.bili&quot;</span>)<br>                .build();<br>        <span class="hljs-comment">//获取内存管理器</span><br>        <span class="hljs-type">Memory</span> <span class="hljs-variable">memory</span> <span class="hljs-operator">=</span> emulator.getMemory();<br>        <span class="hljs-comment">//设置android api版本 只能是23否则报错</span><br>        memory.setLibraryResolver(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AndroidResolver</span>(<span class="hljs-number">23</span>));<br>        <span class="hljs-comment">//获取dalvik虚拟机</span><br>        vm = emulator.createDalvikVM(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">&quot;unidbg-android/src/test/resources/example_binaries/android_lib/bilibili.so&quot;</span>));<br>        <span class="hljs-comment">//调用java方法时可以继续执行</span><br>        <span class="hljs-comment">//vm.setDvmClassFactory(new ProxyClassFactory());</span><br>        <span class="hljs-comment">//开启log</span><br>        vm.setJni(<span class="hljs-built_in">this</span>);<br>        vm.setVerbose(<span class="hljs-literal">true</span>);<br>        <span class="hljs-comment">//加载so</span><br>        dm = vm.loadLibrary(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">&quot;unidbg-android/src/test/resources/example_binaries/android_lib/libbili.so&quot;</span>),<br>                <span class="hljs-literal">false</span>);<br>        <span class="hljs-keyword">module</span> = dm.getModule();<br>        dm.callJNI_OnLoad(emulator);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">destroy</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        emulator.close();<br>    &#125;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">bytesToString</span><span class="hljs-params">(<span class="hljs-type">byte</span>[] bytes)</span> &#123;<br>        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">byte</span> b : bytes) &#123;<br>            sb.append((<span class="hljs-type">char</span>)b);<br>        &#125;<br>        <span class="hljs-keyword">return</span> sb.toString();<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">call_sign</span><span class="hljs-params">(String data,<span class="hljs-type">byte</span>[] p_data)</span>&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">data_len</span> <span class="hljs-operator">=</span> data.length();<br>        <span class="hljs-type">Memory</span> <span class="hljs-variable">memory</span> <span class="hljs-operator">=</span> emulator.getMemory();            <span class="hljs-comment">//获取内存操作接口</span><br>        <span class="hljs-type">MemoryBlock</span> <span class="hljs-variable">sign</span> <span class="hljs-operator">=</span> memory.malloc(<span class="hljs-number">33</span>,<span class="hljs-literal">false</span>);    <span class="hljs-comment">//申请空间</span><br>        <span class="hljs-type">UnidbgPointer</span> <span class="hljs-variable">sign_ptr</span> <span class="hljs-operator">=</span> sign.getPointer();          <span class="hljs-comment">//获取指针</span><br><br>        <span class="hljs-type">MemoryBlock</span> <span class="hljs-variable">data_block</span> <span class="hljs-operator">=</span> memory.malloc(data_len,<span class="hljs-literal">false</span>);<br>        <span class="hljs-type">UnidbgPointer</span> <span class="hljs-variable">data_ptr</span> <span class="hljs-operator">=</span> data_block.getPointer();<br>        data_ptr.write(data.getBytes());<br><br>        <span class="hljs-type">MemoryBlock</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> memory.malloc(<span class="hljs-number">17</span>,<span class="hljs-literal">false</span>);<br>        <span class="hljs-type">UnidbgPointer</span> <span class="hljs-variable">p_ptr</span> <span class="hljs-operator">=</span> p.getPointer();<br>        p_ptr.write(p_data);<br>        <span class="hljs-comment">//传参</span><br>        List&lt;Object&gt; args = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Object&gt;();<br>        args.add(sign_ptr);<br>        args.add(data_ptr);<br>        args.add(data_len);<br>        args.add(p_ptr);<br><br>        <span class="hljs-keyword">module</span>.callFunction(emulator, <span class="hljs-number">0x18FF0</span>, args.toArray());<br>        <span class="hljs-type">byte</span>[] output = sign_ptr.getByteArray(<span class="hljs-number">0</span>,<span class="hljs-number">0x20</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">Sign</span> <span class="hljs-operator">=</span> bytesToString(output);<br>        System.out.println(<span class="hljs-string">&quot;sign=0x&quot;</span>+ Sign);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">x2d1</span> <span class="hljs-variable">x2d1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">x2d1</span>();<br>        <span class="hljs-type">byte</span>[] p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[] &#123;(<span class="hljs-type">byte</span>)<span class="hljs-number">0xcc</span>,<span class="hljs-number">0x52</span>,<span class="hljs-number">0x0c</span>,<span class="hljs-number">0x56</span>,(<span class="hljs-type">byte</span>)<span class="hljs-number">0xd0</span>,(<span class="hljs-type">byte</span>)<span class="hljs-number">0xfe</span>,(<span class="hljs-type">byte</span>)<span class="hljs-number">0x88</span>,(<span class="hljs-type">byte</span>)<span class="hljs-number">0xd2</span>,(<span class="hljs-type">byte</span>)<span class="hljs-number">0xd1</span>,(<span class="hljs-type">byte</span>)<span class="hljs-number">0x9e</span>,(<span class="hljs-type">byte</span>)<span class="hljs-number">0x85</span>,<span class="hljs-number">0x45</span>,<span class="hljs-number">0x73</span>,(<span class="hljs-type">byte</span>)<span class="hljs-number">0xd9</span>,(<span class="hljs-type">byte</span>)<span class="hljs-number">0xff</span>,(<span class="hljs-type">byte</span>)<span class="hljs-number">0x8b</span>&#125;;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;access_key=bb65940d751c90359ebe2d466ece6541CjAvuTqJd7FENl2tpRvB-jzJ403-VVFM7KNe0tt319UeIwA7PgrmQqzDJ7ilEkZI12ISVndfdXUwOHZsR1FqRWVQWjBVc2wwaC1VRUctR0lRVlBMaGVISTJIZ0VrWnRtNXkwWHhBOGxoN1J4dnRSRnhhNGNfZ1gxbXl0TmU0ZEJxSnp2OUZYT1ZBIIEC&amp;appkey=1d8b6e7d45233436&amp;build=8420400&amp;c_locale=zh-Hans_CN&amp;channel=html5_share_source_qqchat&amp;device=phone&amp;disable_rcmd=0&amp;mobi_app=android&amp;network=wifi&amp;platform=android&amp;s_locale=zh-Hans_CN&amp;screen_height=1794&amp;screen_width=1080&amp;selected=&amp;statistics=%7B%22appId%22%3A1%2C%22platform%22%3A3%2C%22version%22%3A%228.42.0%22%2C%22abtest%22%3A%22%22%7D&amp;ts=1745846090&quot;</span>;<br>        x2d1.call_sign(data,p);<br>        x2d1.destroy();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p class='item-img' data-src='/2025/04/09/bangbang_protect_1/'><img src="/2025/04/09/bangbang_protect_1/"></p>
<h3 id="DdTLM"><a href="#DdTLM" class="headerlink" title="DdTLM"></a>算法还原</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java">__int64 __fastcall <span class="hljs-title function_">sub_18FF0</span><span class="hljs-params">(__int64 sign, <span class="hljs-type">char</span> *data, __int64 len_1, <span class="hljs-type">int</span> *salt)</span><br>&#123;<br>  unsigned <span class="hljs-type">int</span> len; <span class="hljs-comment">// w21</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// w25</span><br>  __int64 result; <span class="hljs-comment">// x0</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// w28</span><br>  _DWORD delta[<span class="hljs-number">22</span>]; <span class="hljs-comment">// [xsp+48h] [xbp-C8h] BYREF</span><br>  <span class="hljs-type">char</span> output[<span class="hljs-number">24</span>]; <span class="hljs-comment">// [xsp+A0h] [xbp-70h] BYREF</span><br>  __int64 v13; <span class="hljs-comment">// [xsp+B8h] [xbp-58h]</span><br><br>  len = len_1;<br>  v13 = *(_ReadStatusReg(TPIDR_EL0) + <span class="hljs-number">40</span>);<br>  memset(output, <span class="hljs-number">0</span>, sizeof(output));<br>  memset(delta, <span class="hljs-number">0</span>, sizeof(delta));<br>  sub_FFAC(delta);               <span class="hljs-comment">//init delta</span><br>  sub_FFC0(delta, data, len);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; ++i )<br>  &#123;<br>    sprintf(output, <span class="hljs-string">&quot;%08x&quot;</span>, salt[i]);   <span class="hljs-comment">//</span><br>    sub_FFC0(delta, output, 8u);<br>  &#125;<br>  result = sub_12DD0(output, delta);<br>  <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">16</span>; ++j )<br>    result = sprintf((sign + 2LL * j), <span class="hljs-string">&quot;%02x&quot;</span>, output[j]);<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>在sub_FFAC中找到了MD5的常数，猜测传入的十六字节数据应该是salt，和数据拼起来计算MD5</p>
<p class='item-img' data-src='/2025/04/09/bangbang_protect_1/'><img src="/2025/04/09/bangbang_protect_1/"></p>
<p>CyberChef验证一下，完全正确</p>
<p class='item-img' data-src='/2025/04/09/bangbang_protect_1/'><img src="/2025/04/09/bangbang_protect_1/"></p>
<p class='item-img' data-src='/2025/04/09/bangbang_protect_1/'><img src="/2025/04/09/bangbang_protect_1/"></p>
<h2 id="aWenL"><a href="#aWenL" class="headerlink" title="aWenL"></a>总结</h2>
app似乎没有对抓包进行检测，很容易就抓到包，对frida的检测java层也没有什么混淆，直接就定位导了关键的方法。Native层虽然有OLLVM混淆，但是用插件去一下混淆还是比较好分析的。



<p>最后贴下frida脚本</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook_dlopen</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> detect_so = <span class="hljs-string">&quot;libmsaoaidsec.so&quot;</span>;<br>    <span class="hljs-keyword">var</span> dump_so = <span class="hljs-string">&quot;libbili.so&quot;</span>;<br>    <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(<span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-literal">null</span>, <span class="hljs-string">&quot;android_dlopen_ext&quot;</span>), &#123;<br>        <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">args</span>) &#123;<br>            <span class="hljs-keyword">if</span>(args[<span class="hljs-number">0</span>] != <span class="hljs-literal">null</span>)&#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;dlopen called with filename: &#x27;</span> + <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readUtf8String</span>(args[<span class="hljs-number">0</span>]));<br>            &#125;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">pass</span> = <span class="hljs-number">0</span>;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dump</span> = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readUtf8String</span>(args[<span class="hljs-number">0</span>]).<span class="hljs-title function_">indexOf</span>(detect_so) != -<span class="hljs-number">1</span>)&#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;libmsaoaidsec.so loaded&quot;</span>);<br>                args[<span class="hljs-number">0</span>] = <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">allocUtf8String</span>(<span class="hljs-string">&quot;libc.so&quot;</span>);<br>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">pass</span> = <span class="hljs-number">1</span>;<br>            &#125;<br>        &#125;,<br>        <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">retval</span>)&#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">pass</span> == <span class="hljs-number">1</span>)&#123;<br>                <span class="hljs-comment">//dump(dump_so);</span><br>                <span class="hljs-comment">//hook_javaMethod();</span><br>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">pass</span> = <span class="hljs-number">0</span>;<br>            &#125;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;return&quot;</span>);<br>            <span class="hljs-keyword">return</span> retval;<br>      &#125;<br>    &#125;<br>    );<br>&#125;<br><br><span class="hljs-comment">// function dump(filename)&#123;</span><br><span class="hljs-comment">//     var handle = Process.getModuleByName(filename);</span><br><span class="hljs-comment">//     console.log(&quot;[dumping...........]&quot;);</span><br><span class="hljs-comment">//     var path = &quot;/data/data/tv.danmaku.bili/&quot; + handle.name + &quot;_&quot; + handle.base + &quot;_&quot; + ptr(handle.size) + &quot;.so&quot;;</span><br><span class="hljs-comment">//     var file_handle = new File(path, &quot;wb&quot;);</span><br><span class="hljs-comment">//     if(!file_handle) &#123;</span><br><span class="hljs-comment">//         console.log(&quot;[dump] failed to open file&quot;);</span><br><span class="hljs-comment">//     &#125;</span><br><span class="hljs-comment">//         Memory.protect(ptr(handle.base), handle.size, &#x27;rwx&#x27;);</span><br><span class="hljs-comment">//         var libbuffer = ptr(handle.base).readByteArray(handle.size);</span><br><span class="hljs-comment">//         file_handle.write(libbuffer);</span><br><span class="hljs-comment">//         file_handle.close();</span><br><span class="hljs-comment">//         console.log(&quot;[dump] finished path is &quot; + path);</span><br><span class="hljs-comment">//     &#125;</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook_javaMethod</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>            <span class="hljs-keyword">let</span> <span class="hljs-title class_">BiliPassportApi</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.bilibili.lib.accounts.BiliPassportApi&quot;</span>);<br>            <span class="hljs-title class_">BiliPassportApi</span>[<span class="hljs-string">&quot;M&quot;</span>].<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">str, str2, map, str3, str4, str5, str6, str7, str8, deviceMetaDelegate</span>) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(map.<span class="hljs-property">$className</span>);<br>            <br>            <br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`BiliPassportApi.M is called: str=<span class="hljs-subst">$&#123;str&#125;</span>, str2=<span class="hljs-subst">$&#123;str2&#125;</span>, map=<span class="hljs-subst">$&#123;map&#125;</span>, str3=<span class="hljs-subst">$&#123;str3&#125;</span>, str4=<span class="hljs-subst">$&#123;str4&#125;</span>, str5=<span class="hljs-subst">$&#123;str5&#125;</span>, str6=<span class="hljs-subst">$&#123;str6&#125;</span>, str7=<span class="hljs-subst">$&#123;str7&#125;</span>, str8=<span class="hljs-subst">$&#123;str8&#125;</span>, deviceMetaDelegate=<span class="hljs-subst">$&#123;deviceMetaDelegate&#125;</span>`</span>);<br>            <span class="hljs-keyword">let</span> result = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;M&quot;</span>](str, str2, map, str3, str4, str5, str6, str7, str8, deviceMetaDelegate);<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`BiliPassportApi.M result=<span class="hljs-subst">$&#123;result&#125;</span>`</span>);<br>            <span class="hljs-keyword">return</span> result;<br>        &#125;;<br><br><span class="hljs-comment">//         let PassportCommParams = Java.use(&quot;com.bilibili.lib.accounts.PassportCommParams&quot;);</span><br><span class="hljs-comment">//         PassportCommParams[&quot;attachDeviceParams&quot;].implementation = function (map) &#123;</span><br><span class="hljs-comment">//         let result = this[&quot;attachDeviceParams&quot;](map);</span><br><span class="hljs-comment">//         let josnmap = Java.cast(result,Java.use(&quot;java.util.HashMap&quot;));</span><br><span class="hljs-comment">//         console.log(josnmap);</span><br><span class="hljs-comment">//         return result;</span><br><span class="hljs-comment">// &#125;;</span><br>            <span class="hljs-keyword">let</span> <span class="hljs-title class_">SignedQuery</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.bilibili.nativelibrary.SignedQuery&quot;</span>);<br>            <span class="hljs-title class_">SignedQuery</span>[<span class="hljs-string">&quot;$init&quot;</span>].<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">str, str2</span>) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`SignedQuery.$init is called: str=<span class="hljs-subst">$&#123;str&#125;</span>, str2=<span class="hljs-subst">$&#123;str2&#125;</span>\n`</span>);<br>            <span class="hljs-comment">//showStacks();</span><br>            <span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;$init&quot;</span>](str, str2);<br>&#125;;<br>     <span class="hljs-keyword">let</span> <span class="hljs-title class_">LibBili</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.bilibili.nativelibrary.LibBili&quot;</span>);<br><span class="hljs-comment">//     LibBili[&quot;signQuery&quot;].overload(&#x27;java.util.Map&#x27;).implementation = function (map) &#123;</span><br><span class="hljs-comment">//     console.log(`LibBili.signQuery is called: map=$&#123;map&#125;`);</span><br><span class="hljs-comment">//     let result = this[&quot;signQuery&quot;](map);</span><br><span class="hljs-comment">//     console.log(`LibBili.signQuery result=$&#123;result&#125;`);</span><br><span class="hljs-comment">//     return result;</span><br><span class="hljs-comment">// &#125;;</span><br>    <span class="hljs-title class_">LibBili</span>[<span class="hljs-string">&quot;s&quot;</span>].<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">sortedMap</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`LibBili.s is called: sortedMap=<span class="hljs-subst">$&#123;sortedMap&#125;</span>`</span>);<br>    <span class="hljs-keyword">let</span> result = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;s&quot;</span>](sortedMap);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`LibBili.s result=<span class="hljs-subst">$&#123;result&#125;</span>`</span>);<br>    <span class="hljs-keyword">return</span> result;<br>&#125;;<br>    <span class="hljs-keyword">let</span> <span class="hljs-title class_">AuthInterceptor</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.bilibili.lib.accounts.AuthInterceptor&quot;</span>);<br>    <span class="hljs-title class_">AuthInterceptor</span>[<span class="hljs-string">&quot;b&quot;</span>].<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`AuthInterceptor.b is called`</span>);<br>    <span class="hljs-keyword">let</span> result = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;b&quot;</span>]();<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`AuthInterceptor.b result=<span class="hljs-subst">$&#123;result&#125;</span>`</span>);<br>    <span class="hljs-keyword">return</span> result;<br>&#125;;<br>    &#125;);<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">showStacks</span>(<span class="hljs-params"></span>) &#123;   <span class="hljs-comment">//用来查看堆栈信息</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;android.util.Log&quot;</span>)<br>    .<span class="hljs-title function_">getStackTraceString</span>(<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;java.lang.Throwable&quot;</span>).$new()<br>    )<br>    );<br>    &#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook_native</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> base = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findBaseAddress</span>(<span class="hljs-string">&quot;libbili.so&quot;</span>);<br>    <span class="hljs-keyword">if</span>(base)&#123;<br>        <span class="hljs-keyword">var</span> sub_18FF0 = base.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x18FF0</span>);<br>        <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(sub_18FF0,&#123;<br>            <span class="hljs-attr">onEnter</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">args</span>)&#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;sub_18FF0 called&quot;</span>);<br>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">sign</span> = args[<span class="hljs-number">0</span>];<br>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span> = args[<span class="hljs-number">1</span>];<br>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">salt</span> = args[<span class="hljs-number">3</span>];<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;str2 = &quot;</span> + <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readCString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>));<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;salt = &quot;</span> + <span class="hljs-title function_">byte2hexString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">salt</span>,<span class="hljs-number">16</span>) + <span class="hljs-string">&quot;\n&quot;</span>);<br>            &#125;,<br>            <span class="hljs-attr">onLeave</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">retval</span>)&#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;sub_18FF0 return&quot;</span>);<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;sign = &quot;</span> + <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readCString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">sign</span>));<br>            &#125;<br>        &#125;);<br>        <span class="hljs-keyword">var</span> sub_15C10 = base.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x15C10</span>);<br>        <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(sub_15C10,&#123;<br>            <span class="hljs-attr">onEnter</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">args</span>)&#123;<br>                <span class="hljs-comment">//console.log(&quot;sub_15C10 called&quot;);</span><br>            &#125;,<br>            <span class="hljs-attr">onLeave</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">retval</span>)&#123;<br>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">retval</span> = retval;<br>                <span class="hljs-keyword">var</span> pointer = <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readPointer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">retval</span>);<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;sub_15C10 ret &quot;</span> + <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readCString</span>(pointer));<br>                <span class="hljs-comment">//console.log(&quot;sub_15C10 return&quot;);</span><br>            &#125;<br>        &#125;);<br>        <span class="hljs-keyword">var</span> sub_FFC0 = base.<span class="hljs-title function_">add</span>(<span class="hljs-number">0xFFC0</span>);<br>        <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(sub_FFC0,&#123;<br>            <span class="hljs-attr">onEnter</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">args</span>)&#123;<br>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">input</span> = args[<span class="hljs-number">0</span>];<br>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span> = args[<span class="hljs-number">1</span>];<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;sub_FFC0 before args[0]=&quot;</span> + <span class="hljs-title function_">byte2hexString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">input</span>,<span class="hljs-number">16</span>) + <span class="hljs-string">&quot;\n&quot;</span>);<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;sub_FFC0 before args[1]=&quot;</span> + <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readCString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>) + <span class="hljs-string">&quot;\n&quot;</span>);<br>                <span class="hljs-comment">//console.log(&quot;sub_FFC0 called&quot;);</span><br>            &#125;,<br>            <span class="hljs-attr">onLeave</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">retval</span>)&#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;sub_FFC0 after args[0]=&quot;</span> + <span class="hljs-title function_">byte2hexString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">input</span>,<span class="hljs-number">16</span>) + <span class="hljs-string">&quot;\n&quot;</span>);<br>                <br>                <span class="hljs-comment">//console.log(&quot;sub_FFC0 return&quot;);</span><br>            &#125;<br>        &#125;);<br>    &#125;<br>    <br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">byte2hexString</span>(<span class="hljs-params">ptr,len</span>)&#123;<br>        <span class="hljs-keyword">var</span> hexString = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>            <span class="hljs-keyword">var</span> byte = <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readU8</span>(ptr.<span class="hljs-title function_">add</span>(i));<br>            hexString += (<span class="hljs-string">&#x27;0&#x27;</span> + byte.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>)).<span class="hljs-title function_">slice</span>(-<span class="hljs-number">2</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> hexString;<br>&#125;<br><span class="hljs-title function_">setImmediate</span>(hook_dlopen);<br><span class="hljs-comment">//setImmediate(hook_javaMethod);</span><br><span class="hljs-title function_">setImmediate</span>(hook_native);<br></code></pre></td></tr></table></figure>







<div id="paginator"></div></div><div id="post-footer"><div id="pages" style="justify-content: flex-end"><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2025/04/22/android_load_so2/">android中so的加载(二) Prev →</a></div></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧ </a><a class="i-index" id="to-index" href="#toc-div" title="To Catalog">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="Change Theme"></a><a onclick="BgmControl()"><svg id="bgm-control" viewBox="0 0 30 34" fill="#18d1ff" style="width: 24px; transition: transform .3s;margin-top: 4px"><path d="M25.998 23.422V11.29h3.999v12.132h-3.999zM19.497 6.234h4.001v22.243h-4.001V6.234zM12.998.867h4v32.978h-4V.867zm-6.5 5.367h4.001v22.243H6.498V6.234zm-6.5 5.056h4v12.132h-4V11.29z"></path></svg><audio id="bgm" src="/audio/bgm.mp3" autoplay loop crossorigin="anonymous"> </audio></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="/img/faction/x2d1.jpg" alt="Logo" style="margin:0;border-radius:0;"></a><h1 id="Dr"><a href="/">x2d1</a></h1><div id="description"><p></p></div><div id="social-links"><a class="social" target="_blank" rel="noopener" href="https://github.com/x2d1"><i class="fab fa-github" alt="GitHub"></i></a><a class="social" href="mailto:la0da.hy@gmail.com"><i class="fa fa-envelope" alt="E-Mail"></i></a><a class="social" target="_blank" rel="noopener" href="https://t.me/x2d1_0d00"><i class="fa-brands fa-telegram" alt="Telegram"></i></a></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#eKI1k"><span class="toc-number">1.</span> <span class="toc-text">抓包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#r0v2r"><span class="toc-number">2.</span> <span class="toc-text">JAVA层逆向</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#h56gB"><span class="toc-number">3.</span> <span class="toc-text">native逆向</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#VvDIC"><span class="toc-number">3.1.</span> <span class="toc-text">unidbg主动调用生成sign</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DdTLM"><span class="toc-number">3.2.</span> <span class="toc-text">算法还原</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#aWenL"><span class="toc-number">4.</span> <span class="toc-text">总结</span></a></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr> by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas></body></html>